(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{146:function(n,e,t){"use strict";t.r(e),t.d(e,"frontMatter",(function(){return a})),t.d(e,"rightToc",(function(){return l})),t.d(e,"default",(function(){return b}));t(0);var r=t(390);function o(){return(o=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n}).apply(this,arguments)}function c(n,e){if(null==n)return{};var t,r,o=function(n,e){if(null==n)return{};var t,r,o={},c=Object.keys(n);for(r=0;r<c.length;r++)t=c[r],e.indexOf(t)>=0||(o[t]=n[t]);return o}(n,e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);for(r=0;r<c.length;r++)t=c[r],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(o[t]=n[t])}return o}var a={title:"立即执行函数IIFE",sidebar_label:"立即执行函数IIFE"},l=[{value:"隔离作用域",id:"隔离作用域",children:[]},{value:"防止包冲突",id:"防止包冲突",children:[]},{value:"用IIFE写惰性载入",id:"用iife写惰性载入",children:[]}],u={rightToc:l},i="wrapper";function b(n){var e=n.components,t=c(n,["components"]);return Object(r.b)(i,o({},u,t,{components:e,mdxType:"MDXLayout"}),Object(r.b)("p",null,"立即执行函数表达式(Immediately-Invoked Function Expression)"),Object(r.b)("pre",null,Object(r.b)("code",o({parentName:"pre"},{className:"language-js"}),"!function(){ /* code */ }();\n~function(){ /* code */ }();\n-function(){ /* code */ }();\n+function(){ /* code */ }();\n\nvoid function(){ /* code */ }();\n\n// new关键字也能达到这个效果\nnew function(){ /* code */ }\nnew function(){ /* code */ }()\n// 只有传递参数时，才需要最后那个圆括号\n")),Object(r.b)("p",null,"有人做过测试，使用()和void时，效率是最高的，所以推荐大家尽量使用这两种方式。"),Object(r.b)("p",null,"除了惰性和局部作用域避免污染，广告，第三方统计需求这种，也是需要自执行的。"),Object(r.b)("p",null,"FE常用的功能"),Object(r.b)("h2",{id:"隔离作用域"},"隔离作用域"),Object(r.b)("p",null,"防止作用域污染。ES6之前JS原生又不提供块级作用域，所以只能用",Object(r.b)("strong",{parentName:"p"},"函数作用域"),"模拟了。"),Object(r.b)("pre",null,Object(r.b)("code",o({parentName:"pre"},{className:"language-js"}),"// IIFEs（立即执行函数） can also be used to create variables that are inaccessible from the global\n// scope\nconst counter = (function() {\n   var count = 0 // count对象只能通过counter对象里面的方法去调用，与外界隔离\n\n   return {\n       inc: function() { count = count + 1 },\n       get: function() { console.log(count) },\n   }\n})()\n\ncounter.get()\ncounter.inc()\ncounter.get()\n")),Object(r.b)("h2",{id:"防止包冲突"},"防止包冲突"),Object(r.b)("p",null,"如果我们在页面中同时引用了多个js文件，如果这两个文件中有相同的变量定义，那么就会被覆盖掉。试想下面的例子："),Object(r.b)("p",null,"lib_a.js"),Object(r.b)("pre",null,Object(r.b)("code",o({parentName:"pre"},{className:"language-js"}),"var num = 1;\n// code....\n")),Object(r.b)("p",null,"lib_b.js"),Object(r.b)("pre",null,Object(r.b)("code",o({parentName:"pre"},{className:"language-js"}),"var num = 2;\n// code....\n")),Object(r.b)("p",null,"如果在页面中同时引用lib_a.js和lib_a.js两个库，必然导致num变量被覆盖，为了解决这个问题，可以通过IIFE来解决："),Object(r.b)("p",null,"lib_a.js"),Object(r.b)("pre",null,Object(r.b)("code",o({parentName:"pre"},{className:"language-js"}),"(function() {\n        var num = 1;\n        // code....\n})();\n")),Object(r.b)("p",null,"lib_b.js"),Object(r.b)("pre",null,Object(r.b)("code",o({parentName:"pre"},{className:"language-js"}),"(function() {\n        var num = 2;\n        // code....\n})();\n")),Object(r.b)("h2",{id:"用iife写惰性载入"},"用IIFE写惰性载入"),Object(r.b)("p",null,"因为函数被执行引擎以同步的方式立即执行了，所以当你在之后的代码访问这个变量的时候可以直接返回给你计算后的筛选结果了。"),Object(r.b)("p",null,"我们平时写的判断因为判断条件可能会被改变，所以需要每次都进行判断；但是当我们判断的对象是一个在当前页面不会再次被改变的对象时，惰性载入的作用就显示出来了"),Object(r.b)("p",null,"举个栗子，一个视频播放的方法需要对不同的浏览器采取不同的对策，在 IE 中采用 flash ，而其他浏览器中不使用。由于除非换浏览器，否则是否是 IE 这个条件的值不会被改变，这样采用惰性载入，就可以在多次调用时有明显的优势。"),Object(r.b)("pre",null,Object(r.b)("code",o({parentName:"pre"},{className:"language-js"}),"var showVideo = function () {\n   console.log('第一次调用 showVideo')\n\n   if (isIE) {\n       return function () {\n           console.log('在 IE 中调用 showVideo')\n       }\n   } else {\n       return function () {\n           console.log('在 非IE 中国调用 showVideo')\n       }\n   }\n}()\n// 第一次调用 showVideo\n\nshowVideo();\n// 在 非IE 中国调用 showVideo\n\nshowVideo();\n// 在 非IE 中国调用 showVideo\n\nshowVideo();\n// 在 非IE 中国调用 showVideo\n")))}b.isMDXComponent=!0},390:function(n,e,t){"use strict";t.d(e,"a",(function(){return l})),t.d(e,"b",(function(){return s}));var r=t(0),o=t.n(r),c=o.a.createContext({}),a=function(n){var e=o.a.useContext(c),t=e;return n&&(t="function"==typeof n?n(e):Object.assign({},e,n)),t},l=function(n){var e=a(n.components);return o.a.createElement(c.Provider,{value:e},n.children)};var u="mdxType",i={inlineCode:"code",wrapper:function(n){var e=n.children;return o.a.createElement(o.a.Fragment,{},e)}},b=Object(r.forwardRef)((function(n,e){var t=n.components,r=n.mdxType,c=n.originalType,l=n.parentName,u=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&-1===e.indexOf(r)&&(t[r]=n[r]);return t}(n,["components","mdxType","originalType","parentName"]),b=a(t),s=r,p=b[l+"."+s]||b[s]||i[s]||c;return t?o.a.createElement(p,Object.assign({},{ref:e},u,{components:t})):o.a.createElement(p,Object.assign({},{ref:e},u))}));function s(n,e){var t=arguments,r=e&&e.mdxType;if("string"==typeof n||r){var c=t.length,a=new Array(c);a[0]=b;var l={};for(var i in e)hasOwnProperty.call(e,i)&&(l[i]=e[i]);l.originalType=n,l[u]="string"==typeof n?n:r,a[1]=l;for(var s=2;s<c;s++)a[s]=t[s];return o.a.createElement.apply(null,a)}return o.a.createElement.apply(null,t)}b.displayName="MDXCreateElement"}}]);